<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Doctor Listing App</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div class="header">
    <input type="text" id="search-bar" placeholder="Search for doctors..." />
  </div>

  <div class="filters">
    <div class="filter-panel">
      <!-- Single Filter (Radio buttons) -->
      <div class="filter-category">
        <label>Consultation Mode:</label>
        <label><input type="radio" name="consultation-mode" value="video" id="video-consult" /> Video Consult</label>
        <label><input type="radio" name="consultation-mode" value="clinic" id="in-clinic" /> In Clinic</label>
      </div>

      <!-- Multi Filter (Checkboxes) -->
      <div class="filter-category">
        <label>Specialties:</label>
        <label><input type="checkbox" class="specialty" value="General Physician" id="filter-specialty-General-Physician" /> General Physician</label>
        <label><input type="checkbox" class="specialty" value="Dentist" id="filter-specialty-Dentist" /> Dentist</label>
        <label><input type="checkbox" class="specialty" value="Dermatologist" id="filter-specialty-Dermatologist" /> Dermatologist</label>
        <label><input type="checkbox" class="specialty" value="Paediatrician" id="filter-specialty-Paediatrician" /> Paediatrician</label>
        <label><input type="checkbox" class="specialty" value="Gynaecologist" id="filter-specialty-Gynaecologist" /> Gynaecologist</label>
        <label><input type="checkbox" class="specialty" value="ENT" id="filter-specialty-ENT" /> ENT</label>
        <label><input type="checkbox" class="specialty" value="Diabetologist" id="filter-specialty-Diabetologist" /> Diabetologist</label>
        <label><input type="checkbox" class="specialty" value="Cardiologist" id="filter-specialty-Cardiologist" /> Cardiologist</label>
        <label><input type="checkbox" class="specialty" value="Physiotherapist" id="filter-specialty-Physiotherapist" /> Physiotherapist</label>
        <label><input type="checkbox" class="specialty" value="Endocrinologist" id="filter-specialty-Endocrinologist" /> Endocrinologist</label>
        <label><input type="checkbox" class="specialty" value="Orthopaedic" id="filter-specialty-Orthopaedic" /> Orthopaedic</label>
        <label><input type="checkbox" class="specialty" value="Ophthalmologist" id="filter-specialty-Ophthalmologist" /> Ophthalmologist</label>
        <label><input type="checkbox" class="specialty" value="Gastroenterologist" id="filter-specialty-Gastroenterologist" /> Gastroenterologist</label>
        <label><input type="checkbox" class="specialty" value="Pulmonologist" id="filter-specialty-Pulmonologist" /> Pulmonologist</label>
        <label><input type="checkbox" class="specialty" value="Psychiatrist" id="filter-specialty-Psychiatrist" /> Psychiatrist</label>
        <label><input type="checkbox" class="specialty" value="Urologist" id="filter-specialty-Urologist" /> Urologist</label>
        <label><input type="checkbox" class="specialty" value="Dietitian/Nutritionist" id="filter-specialty-Dietitian-Nutritionist" /> Dietitian/Nutritionist</label>
        <label><input type="checkbox" class="specialty" value="Psychologist" id="filter-specialty-Psychologist" /> Psychologist</label>
        <label><input type="checkbox" class="specialty" value="Sexologist" id="filter-specialty-Sexologist" /> Sexologist</label>
        <label><input type="checkbox" class="specialty" value="Nephrologist" id="filter-specialty-Nephrologist" /> Nephrologist</label>
        <label><input type="checkbox" class="specialty" value="Neurologist" id="filter-specialty-Neurologist" /> Neurologist</label>
        <label><input type="checkbox" class="specialty" value="Oncologist" id="filter-specialty-Oncologist" /> Oncologist</label>
        <label><input type="checkbox" class="specialty" value="Ayurveda" id="filter-specialty-Ayurveda" /> Ayurveda</label>
        <label><input type="checkbox" class="specialty" value="Homeopath" id="filter-specialty-Homeopath" /> Homeopath</label>
      </div>

      <!-- Sort Filter -->
      <div class="filter-category">
        <label for="sort">Sort By:</label>
        <select id="sort">
          <option value="fee">Fees (Low to High)</option>
          <option value="experience">Experience (High to Low)</option>
        </select>
      </div>
    </div>
  </div>

  <div id="doctor-list"></div>

  <script>
    window.onload = () => {
      const apiUrl = "https://srijandubey.github.io/campus-api-mock/SRM-C1-25.json";
  
      // Fetch data from the API
      fetch(apiUrl)
        .then(response => response.json())
        .then(data => {
          const doctorListDiv = document.getElementById('doctor-list');
          let allDoctors = [...data]; // Store all doctors for filtering and sorting
  
          const displayDoctors = (doctors) => {
            doctorListDiv.innerHTML = ''; // Clear current list
            doctors.forEach(doctor => {
              const doctorCard = document.createElement('div');
              doctorCard.classList.add('doctor-card');
              doctorCard.innerHTML = `
                <div class="doctor-photo">
                  <img src="${doctor.photo}" alt="${doctor.name}" />
                </div>
                <h2>${doctor.name}</h2>
                <p><span>Specialty:</span> ${doctor.specialities.map(spec => spec.name).join(', ')}</p>
                <p><span>Experience:</span> ${doctor.experience}</p>
                <p><span>Fee:</span> ${doctor.fees}</p>
                <p><span>Clinic:</span> ${doctor.clinic.name}, ${doctor.clinic.address.locality}, ${doctor.clinic.address.city}</p>
                <p><span>Consultation Mode:</span> ${doctor.video_consult ? 'Video Consult' : 'In Clinic'}</p>
              `;
              doctorListDiv.appendChild(doctorCard);
            });
          };
  
          // Display doctors initially
          displayDoctors(allDoctors);
  
          // Filter and Sort functionality
          const consultationModeRadios = document.querySelectorAll('input[name="consultation-mode"]');
          const specialtyCheckboxes = document.querySelectorAll('.specialty');
          const sortSelect = document.getElementById('sort');
          const searchBar = document.getElementById('search-bar');
  
          const filterAndSortDoctors = () => {
            let filteredDoctors = [...allDoctors]; // Start with all doctors
  
            // Filter by consultation mode (radio buttons)
            const selectedMode = Array.from(consultationModeRadios).find(radio => radio.checked)?.value;
            if (selectedMode) {
              filteredDoctors = filteredDoctors.filter(doctor => {
                if (selectedMode === 'video' && doctor.video_consult) return true;
                if (selectedMode === 'clinic' && doctor.in_clinic) return true;
                return false;
              });
            }
  
            // Filter by specialties (checkboxes)
            const selectedSpecialties = Array.from(specialtyCheckboxes)
              .filter(checkbox => checkbox.checked)
              .map(checkbox => checkbox.value);
            if (selectedSpecialties.length > 0) {
              filteredDoctors = filteredDoctors.filter(doctor =>
                doctor.specialities.some(spec => selectedSpecialties.includes(spec.name))
              );
            }
  
            // Sort by selected option
            const selectedSort = sortSelect.value;
            if (selectedSort === 'fee') {
              filteredDoctors.sort((a, b) => parseInt(a.fees.replace('₹', '').replace(',', '')) - parseInt(b.fees.replace('₹', '').replace(',', '')));
            } else if (selectedSort === 'experience') {
              filteredDoctors.sort((a, b) => parseInt(b.experience) - parseInt(a.experience));
            } else if (selectedSort === 'name') {
              filteredDoctors.sort((a, b) => a.name.localeCompare(b.name));
            }
  
            // Display the filtered and sorted doctors
            displayDoctors(filteredDoctors);
          };
  
          // Add event listeners to trigger filtering and sorting
          consultationModeRadios.forEach(radio => radio.addEventListener('change', filterAndSortDoctors));
          specialtyCheckboxes.forEach(checkbox => checkbox.addEventListener('change', filterAndSortDoctors));
          sortSelect.addEventListener('change', filterAndSortDoctors);
  
          // Search Bar functionality
          searchBar.addEventListener('input', () => {
            const searchQuery = searchBar.value.toLowerCase();
            const searchedDoctors = allDoctors.filter(doctor =>
              doctor.name.toLowerCase().includes(searchQuery) ||
              doctor.specialities.some(spec => spec.name.toLowerCase().includes(searchQuery))
            );
            displayDoctors(searchedDoctors);
          });
  
        })
        .catch(error => console.error('Error fetching data:', error));
    };
  </script>
  
  
</body>
</html>
